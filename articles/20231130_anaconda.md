---
title: "Anacondaを使ってPythonの環境構築をする"
emoji: "🙌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [Python,Anaconda,MachineLearning]
published: false
Author: yuuma
---

&nbsp;

:::message
今回の記事に対応する動画は以下からアクセスすることができます｡
__[Anacondaを使ってPythonの環境構築をする 導入編～Spyder](https://togotv.dbcls.jp/20230301.html)__
__[Anacondaを使ってPythonの環境構築をする 発展編](https://togotv.dbcls.jp/20230301.html)__
:::
https://youtu.be/vKRxCpn2KbA?si=sqPKsRMgCgDwK_V6
https://youtu.be/vKRxCpn2KbA?si=sqPKsRMgCgDwK_V6
:::message alert
本動画ではAnacondaを用いたPythonの環境構築を行います｡
__PipでPythonをマシンに導入している場合は、ライブラリが競合する恐れがあります。Anacondaをインストールする前にPip環境を削除することをおすすめします｡__
:::


&nbsp;

# はじめに

:::message
__本記事の対象となる方__

■ Pythonをローカルマシンに構築したい人
■ Pythonのライブラリをラクに管理したい人
■ Pythonの仮想環境を構築したい人
■ Anacondaを使って機械学習をしたい人
:::

この記事では、以下の2点をご紹介します。
__(1) WindowsマシンにAnacondaをインストールする__
__(2) Anacondaでインストールされるアプリ（Spyder、Jupyter Notebook）を使う__
__(3) Spyder特有の機能紹介と、Spyderを用いてデバッグ方法を行う__
__(4) Anacondaで仮想環境を構築する__
__(5) Anacondaでデータ解析、機械学習を行う__

&nbsp;
### Anacondaを使うメリット

本記事を参考にすることで、ローカルマシンにAnacondaをインストールし、Pythonの環境構築を行うことができます。

Anacondaは、__データ分析や科学計算に特化したPythonの統合開発環境__ を提供しています。__良く用いられるライブラリが同時にインストールされる__ ため、Anacondaをインストールするだけで、ほとんどの作業をすぐに始めることができます。

特に、高機能なエディタである __Spyder__ や、ノートブック形式でプログラムを作成できる __Jupyter Notebook__ を使うことで、データ分析や機械学習をより効率的に行うことができます。
さらに、__Anaconda Navigator__ というGUIツールによって、ライブラリの管理、仮想環境の作成・管理を直感的に行うこともできます。

&nbsp;

# Anacondaをインストールする
今回はAnacondaをWindowsマシンにインストールします。Anacondaは、Windows、Mac、Linuxの各OSに対応しています。インストーラは、[Anaconda公式サイトのダウンロードページ](https://www.anaconda.com/download)からダウンロードすることができます。
![install](/images/20231130/20231130_01.png =500x)
*Anacondaのインストールサイト*
Anacondaのインストーラをダウンロードしたら、インストーラを起動して、インストールを行います。インストールの際の注意点は以下の通りです：
:::message
- インストール先のパスには、__半角英数字と "_"（アンダーバー）および "-"（ハイフン）__ 以外の文字を含めないようにしてください。
- `Install for:`の画面では、__`Just Me`をおすすめします。__`All Users`は、同じマシンを使っている別のユーザーの環境に影響を与える可能性があります。
- `Advanced Installation Options`は既定のままで問題ありません。
- `Add Anaconda to my PATH environment variable`は、__チェックを入れなくても構いません。__ チェックを入れた場合は、Anacondaのコマンドをコマンドプロンプトから実行できるようになります。入れない場合は、Anaconda Navigatorから実行することになります。
:::

# Anaconda Navigatorから各アプリケーションを使う
Anacondaをインストールすると、__Anaconda Navigator__ というGUIツールがインストールされます。Jupyter NotebookやSpyderなどのアプリケーションは、ここから起動します。Anaconda Navigatorを起動するには、スタートメニューからAnaconda Navigatorを選択します。

![anaconda navigator](/images/20231130/20231130_02.png)
*Anaconda Navigatorの起動画面*

`Launch`ボタンから各アプリケーションを起動することができます。また、`Environments`タブから、仮想環境の作成や管理を行うことができます。仮想環境については後述します。

### Jupyter Notebookを起動する
Jupyter Notebookは、__ブラウザ上でPythonプログラムを実行できるアプリケーション__ です。ファイルやフォルダの作成方法は動画を参照してください。

`New`から`Python 3 (ipykernel)`を選択すると、Notebookファイルを作成できます。Notebookファイルは、拡張子が`.ipynb`のファイルです。
![jupyter notebook](/images/20231130/20231130_03.png)
*フォルダ名やファイル名は`Rename`から変更可能*

Notebookファイルでは、`In [ ]:`の部分にPythonのコードを入力して、`Shift + Enter`を押すと、そのコードが実行されます。`In [ ]:`の部分には、実行した順番に番号が振られます。
また、`+`ボタンから、新しいセルを追加することができます。セルの種類は、`Code`と`Markdown`の2種類があります：

- `Code`はPythonのコードを実行できる。
- `Markdown`はテキストを __Markdown記法__ で記述できる。

Anacondaのインストール時点で、科学計算やデータ分析に必要なライブラリがインストールされているため、すぐにデータ分析を始めることができます。例えば、以下のコードを実行すると、Notebook上にグラフが表示されます。

```python:グラフを表示するコード
import numpy as np
import matplotlib.pyplot as plt

x=np.linspace(0,10,100)
plt.plot(x,np.sin(x))
```

### Spyderを起動する
Spyderは、__高機能なPythonの統合開発環境__ です。変数の中身を確認したり、デバッグを行うことができます。また、関数や変数の補完機能や、リアルタイムでのエラー表示も備えており、プログラムの作成を効率化することができます。

# Spyderに特有の機能について
Spyderには、以下のような特徴的な機能があります：
- 変数の中身を確認できる。
- グラフを履歴として一時的に保存できる。
- デバッグを行うことができる。

### 変数エクスプローラーとプロット機能
動画内で詳しく説明していますが、Spyder右上のウィンドウにある __変数エクスプローラー (Variable Explorer)__ タブから、変数の中身を確認することができます。また、__プロット (Plots)__ タブから、グラフを履歴として一時的に保存することができます。これらの機能は、データ分析を行う際に非常に便利です。

![spyder](/images/20231130/20231130_04.png =1000x)
*変数エクスプローラーで配列の中身を確認できる。*
![spyder](/images/20231130/20231130_05.png =1000x)
*プロットを独立したウィンドウで確認できる。プロット履歴も残っている。*

### Pythonプログラムのデバッグを行う
Spyderには、プログラムを行単位で実行したり、任意の場所で実行を一時停止するデバッグ機能がデフォルトで存在します。
__エディター上部の青いボタン群__ がデバッグ機能です。青いボタンには、左から以下のような機能があります：
- デバッグを実行する
- 1行ずつ実行する
- 関数内へのステップイン
- 関数の最後まで実行する
- 次のブレークポイントまで実行する
- デバッグを中断する

これらの機能を用途によって使い分けることができます。
![spyder](/images/20231130/20231130_06.png =1000x)
*デバッグ中に変数エクスプローラーを用いると、プログラムの実行に伴う変数の更新がわかる。*

:::message
ここまでが __[Anacondaを使ってPythonの環境構築をする 導入編～Spyder](https://togotv.dbcls.jp/20230301.html)__ の内容です。
:::

# 仮想環境を構築する
Anaconda Navigatorから仮想環境を作成・管理することができます。仮想環境とは、__Pythonのライブラリを独立した環境にインストールすること__ です。仮想環境を使うことで、ライブラリのバージョンを切り替えたり、ライブラリの競合を防ぐことができます。
Anaconda Navigatorの`Environments`タブから、仮想環境の作成・管理を行うことができます。仮想環境の作成方法は動画を参照してください。

![anaconda navigator](/images/20231130/20231130_07.png)
*作成した仮想環境の情報は`Environments`タブから確認できる。*

::: message alert
numpyやmatplotlibなどのライブラリは、Anacondaをインストールした時点でbase(root)環境にはインストールされていますが、__仮想環境ではインストールされていません。__ 
仮想環境を作成したら、必要なライブラリをインストールする必要があります。
:::

### 仮想環境でPythonを実行する
仮想環境を作成したら、その環境でPythonを実行することができます。Anaconda Navigatorの`Home`タブから、`All apprications` on `test` を選択すると、`test`環境内で各アプリケーションを起動することができます。
Spyderを起動したい場合は、`test`環境内にSpyderをインストールする必要があります。先ほど`Launch`と表示されていたものが、`Install`に変化していることを確認してください。

![anaconda navigator](/images/20231130/20231130_08.png)
*仮想環境を選択すると、その環境でアプリケーションを起動できる。*

![spyder](/images/20231130/20231130_09.png =1000x)
*作成した仮想環境では、numpyやmatplotlibなどのライブラリはインストールされていない。*

### 仮想環境にライブラリをインストールする
Anaconda Navigatorの`Environments`タブから、仮想環境にライブラリをインストールすることができます。`test`環境内で、`numpy`と`matplotlib`をインストールするには、`test`環境を選択して、`Installed`のタブを`Not installed`に変更し、`Search Packages`で`numpy`や、`matplotlib`を検索し、`Apply`を押します。

![anaconda navigator](/images/20231130/20231130_10.png)
*仮想環境にライブラリをインストールする。*

### Anaconda Promptを使って仮想環境を構築する
GUI環境のAnaconda Navigatorを使わずに、CUI環境の __Anaconda Prompt__ を使って仮想環境を構築することもできます。Anaconda Promptは、スタートメニューからAnaconda Promptを選択することで起動できます。コマンドプロンプトと同じように、コマンドを入力して実行することができます。

Anaconda Promptを使って仮想環境を構築するには、以下のコマンドを実行します：
```bash:Anaconda Prompt
conda create -n test python=3.6
```
`-n`オプションで、仮想環境の名前を指定します。`python=3.6`は、Pythonのバージョンを指定しています。
ライブラリのインストールもAnaconda Promptで行うことができます。例えば、`numpy`のインストールは、以下のコマンドを実行します：
```bash:Anaconda Prompt
conda install numpy
```
作成した環境一覧は、以下のコマンドで確認できます：
```bash:Anaconda Prompt
conda info -e
```
実行結果は以下のようになります：
```bash
# conda environments:
#
base                  *  C:\Users\yuuma\anaconda3
test                     C:\Users\yuuma\anaconda3\envs\test
```
baseが大元の環境で、testが作成した仮想環境です。`C:\Users\yuuma\anaconda3\envs\test`に仮想環境のフォルダが作成されていることがわかります。__"*"__（アスタリスク）が付いているのは、現在の環境がbaseであることを示しています。

仮想環境に切り替えるには、以下のコマンドを実行します：
```bash:Anaconda Prompt
activate test
```
`activate`コマンドを実行すると、プロンプトの先頭に`(test)`と表示されます。これは、現在の仮想環境が`test`であることを示しています。仮想環境を終了して、大元の環境(base)に戻るためには、以下のコマンドを実行します：
```bash:Anaconda Prompt
deactivate
```
これらのコマンドを使うことで、Anaconda Prompt上で仮想環境を構築することができますが、Anaconda Navigatorでも十分です。

![anaconda prompt](/images/20231130/20231130_11.png)
*Anaconda Promptで仮想環境の確認をし、activateとdeactivateを行っている。*

# Anacondaでデータ解析、機械学習を行う
### ネット上に公開されているZIPファイルからcsvファイルを抽出する


### scikit-learnを使って機械学習を行う
